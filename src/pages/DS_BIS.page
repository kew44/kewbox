<apex:page standardController="DS_Functioning_Forms_B__c" extensions="DS_BIS_Controller">           
    
    <!--JQuery -->
    <apex:includeScript value="{!URLFOR($Resource.jQuery, '/js/jquery-1.9.1.js')}"  /><!--allows for JQuery dependencies-->
    <script> $j = jQuery.noConflict(); </script><!--Reserves the '$' token for JQuery only-->
    
    <!-- Bootstrap -->
        <link href="{!URLFOR($Resource.VFbootstrap3, '/css/VFbootstrap.css')}" rel="stylesheet" media="screen"/>
            <apex:includeScript value="{!URLFOR($Resource.VFbootstrap3, '/js/bootstrap.min.js')}"/>
                
                <!--link to the CSS resource in Salesforce internal document-->
                    <apex:stylesheet value="{!$Resource.CustomCss}" />                                     
                        
                        <!--provides framework for "skip-logic" capabilities-->
                            <script>function setFocusOnLoad() {}</script>
                            
    <script> var skipElement = JSON.parse("{!JSENCODE(skipElementToJson)}"); </script>
    <script src="{!URLFOR($Resource.Scripts, '/skipLogic.js')}"></script>
    
    <!--JQuery script for allowing de-selection of radiobuttons and use of dateModule-->   
    <script>
    $j(document).ready(function(){
        
        dateModule({!dateModuleStatus});//dateModule declaritive 
        
        $j('input[type="radio"]').click(function(){//de-select
            
            var previousValue = $j(this).attr('title');
            var val = $j(this).val();
            var name = $j(this).attr('name');
            
            if (previousValue == val) {  // uncheck radio button
                $j(this).removeAttr('checked').change();
                $j("input[name='"+name+"']:radio").attr('title', '');
            }
            else {
                $j("input[name='"+name+"']:radio").attr('title', val);
            }
            
        });<!--end de-select-->
            
            <!--date module criteria, test for treatment completion-->
                $j('input[name$="BCBISCOMP__c"]').change(function(){
                    dateModule($j('input[name$="BCBISCOMP__c"]:checked').val());
                });
        
    });
    
    <!--date module-->
        function dateModule(value){
            console.log(value);
            if( value == '0'){//client did not complete treatment, display date abandoned
                $j('.skip-No').show();
                $j('.skip-Yes').hide();
                $j('.skip-element-BCBISCODT').val('');
            }  
            else if( value == '1' ){//client completed treatment, display completion date
                $j('.skip-Yes').show();
                $j('.skip-No').hide();
                $j('.skip-element-BCBISLFDT').val('');
            }
                else{//client completion of treatment not specified, do not display any date
                    $j('.skip-No').hide();
                    $j('.skip-element-BCBISLFDT').val('');
                    $j('.skip-Yes').hide();
                    $j('.skip-element-BCBISCODT').val('');
                }
        }
    </script>  <!--End JQuery script block-->
    
    <!-- "Breadcrumb" heading allows user to navigate to the ClientSummary page -->
    <apex:outputPanel rendered="{!if(forceRedirect = '1', false, true)}" layout="none"><!--//display condition based on variable determined by path-->
        <script>
        $j(document).ready(function() {
            $j('.bPageTitle').append('<div class="ptBreadcrumb">&nbsp;«&nbsp;<a href="/apex/ClientSummary?s=0&id={!client.id}">Back to Client Summary</a></div>');
        });
        </script>
    </apex:outputPanel>
    <!--Begin form content-->
    <apex:form id="DS_BIS_FORM" styleClass="form-horizontal">
        <apex:sectionHeader title="BRIEF INTERVENTION SERVICES INFORMATION" subtitle="{!subtitle}"/><br/>
        
        <!-- pageblock to show ClientInformation header as described in Utility class-->
        <apex:pageBlock title="Client Information">
            <div id="force"><apex:outputText value="{!ClientInfo}" escape="false"/></div>
        </apex:pageBlock>
        
        <!-- primary content pageBlock container-->
        <apex:pageBlock title="BRIEF INTERVENTION SERVICES INFORMATION" >
            <apex:pageMessages /><!--placeholding structure that allows for system message display-->
            
            <div id="force"> 
                <table class="table DS-table">
                    <tbody>
                        <!--Begin BIS questionnaire-->
                        
                        <p><b>Brief Intervention refers to the number of sessions that a child/family may receive. If a child/family is only going to receive 3–6 sessions (e.g., crisis response/stabilization), then complete the following.</b></p>
                        
                        <!--1. Is child receiving service?-->
                        <tr>          
                            <td>
                                <b>1.</b>  Is this child/family receiving brief intervention services?
                                <apex:selectRadio styleClass="form-control2" id="BCBISRECV__c" value="{!obj.BCBISRECV__c}" layout="pageDirection" title="{!obj.BCBISRECV__c}" onChange="skipLogic('BCBISRECV',this.value)"><!-- onChange="skipLogic('BCBISRECV',this.value)"onChange="ynModule(this.value)"><!---->
                                    <apex:selectOptions value="{!YNIems}"/>
                                </apex:selectRadio>
                                <b>If Yes:</b> Please complete the requested information for <b>EACH</b> treatment the child/family is receiving through a brief intervention.  A new entry is required for each type of intervention and each distinct set of start/stop dates.
                            </td>    
                        </tr>                       
                        
                        <tr class="skip-BCBISCREE"> <!--Conditional, if Q1 yes----->
                            <td>
                                <b>2.</b>  What treatment component(s) is the child/family receiving for this brief episode of care? <b>(Select all that apply.)</b>
                                <table>
                                    <tr>
                                        
                                        <!--Screening-->
                                        <td class="skipContent checkline "><!--Conditional, if Q1 yes----->
                                            <label>
                                                <apex:inputCheckbox id="BCBISCREE__c" value="{!obj.BCBISCREE__c}" styleClass="form-control2 skip-element-BCBISCREE">  </apex:inputCheckbox>
                                                Screening  
                                            </label>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        
                                        <!-- Assessment-->
                                        <td class="skipContent checkline "><!--Conditional, if Q1 yes----->
                                            <label>
                                                <apex:inputCheckbox id="BCBISASSM__c" value="{!obj.BCBISASSM__c}" styleClass="form-control2 skip-element-BCBISASSM">  </apex:inputCheckbox>
                                                Assessment  
                                            </label>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        
                                        <!--Consultation-->
                                        <td class="skipContent checkline "><!--Conditional, if Q1 yes----->
                                            <label>
                                                <apex:inputCheckbox id="BCBISCONS__c" value="{!obj.BCBISCONS__c}" styleClass="form-control2 skip-element-BCBISCONS">  </apex:inputCheckbox>
                                                Case Consultation  
                                            </label>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        
                                        <!--Management-->
                                        <td class="skipContent checkline "><!--Conditional, if Q1 yes----->
                                            <label>
                                                <apex:inputCheckbox id="BCBISMANA__c" value="{!obj.BCBISMANA__c}" styleClass="form-control2 skip-element-BCBISMANA">  </apex:inputCheckbox>
                                                Case Management 
                                            </label> 
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        
                                        <!--CFTSI-->
                                        <td class="skipContent checkline "><!--Conditional, if Q1 yes----->
                                            <label>
                                                <apex:inputCheckbox id="BCBISCFTS__c" value="{!obj.BCBISCFTS__c}" styleClass="form-control2 skip-element-BCBISCFTS">  </apex:inputCheckbox>
                                                Child and Family Traumatic Stress Intervention (CFTSI)  
                                            </label>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        
                                        <!--PFA-->
                                        <td class="skipContent checkline "><!--Conditional, if Q1 yes----->
                                            <label>
                                                <apex:inputCheckbox id="BCBISPFA__c" value="{!obj.BCBISPFA__c}" styleClass="form-control2 skip-element-BCBISPFA">  </apex:inputCheckbox>
                                                Psychological First Aid (PFA)  
                                            </label>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        
                                        <!--Psychological Recovery Skills-->
                                        <td class="skipContent checkline "><!--Conditional, if Q1 yes----->
                                            <label>
                                                <apex:inputCheckbox id="BCBISSPR__c" value="{!obj.BCBISSPR__c}" styleClass="form-control2 skip-element-BCBISSPR">  </apex:inputCheckbox>
                                                Skills for Psychological Recovery  
                                            </label>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        
                                        <!--Acute Crisis Response-->
                                        <td class="skipContent checkline "><!--Conditional, if Q1 yes----->
                                            <label>
                                                <apex:inputCheckbox id="BCBISCRIM__c" value="{!obj.BCBISCRIM__c}" styleClass="form-control2 skip-element-BCBISCRIM">  </apex:inputCheckbox>
                                                Acute Crisis Response and  Management   
                                            </label>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        
                                        <!--Referral-->
                                        <td class="skipContent checkline "><!--Conditional, if Q1 yes----->
                                            <label>
                                                <apex:inputCheckbox id="BCBISRFSE__c" value="{!obj.BCBISRFSE__c}" styleClass="form-control2 skip-element-BCBISRFSE">  </apex:inputCheckbox>
                                                Referral Services  
                                            </label>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        
                                        <!--Psycho-education-->
                                        <td class="skipContent checkline "><!--Conditional, if Q1 yes----->
                                            <label>
                                                <apex:inputCheckbox id="BCBISPSYE__c" value="{!obj.BCBISPSYE__c}" styleClass="form-control2 skip-element-BCBISPSYE">  </apex:inputCheckbox>
                                                Psycho-education  
                                            </label>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        
                                        <!--Safety Planning-->
                                        <td class="skipContent checkline "><!--Conditional, if Q1 yes----->
                                            <label>
                                                <apex:inputCheckbox id="BCBISSFTP__c" value="{!obj.BCBISSFTP__c}" styleClass="form-control2 skip-element-BCBISSFTP">  </apex:inputCheckbox>
                                                Safety Planning  
                                            </label>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        
                                        <!--Individual Therapy-->
                                        <td class="skipContent checkline "><!--Conditional, if Q1 yes----->
                                            <label>
                                                <apex:inputCheckbox id="BCBISINDT__c" value="{!obj.BCBISINDT__c}" styleClass="form-control2 skip-element-BCBISINDT">  </apex:inputCheckbox>
                                                Individual Therapy  
                                            </label>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        
                                        <!--Family Therapy-->
                                        <td class="skipContent checkline "><!--Conditional, if Q1 yes----->
                                            <label>
                                                <apex:inputCheckbox id="BCBISFAMT__c" value="{!obj.BCBISFAMT__c}" styleClass="form-control2 skip-element-BCBISFAMT">  </apex:inputCheckbox>
                                                Family Therapy  
                                            </label>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        
                                        <!--Group Therapy-->
                                        <td class="skipContent checkline "><!--Conditional, if Q1 yes----->
                                            <label>
                                                <apex:inputCheckbox id="BCBISGRPT__c" value="{!obj.BCBISGRPT__c}" styleClass="form-control2 skip-element-BCBISGRPT">  </apex:inputCheckbox>
                                                Group Therapy   
                                            </label>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        
                                        <!--Support Group-->
                                        <td class="skipContent checkline "><!--Conditional, if Q1 yes----->
                                            <label>
                                                <apex:inputCheckbox id="BCBISSUPG__c" value="{!obj.BCBISSUPG__c}" styleClass="form-control2 skip-element-BCBISSUPG">  </apex:inputCheckbox>
                                                Support Group
                                            </label>
                                        </td>
                                    </tr>
                                    <tr>
                                        <!--Other-->
                                        <td class="skipContent checkline "><!---Conditional, if Q1 yes----->
                                            <label>
                                                <apex:inputCheckbox id="BCBISOTHE__c" value="{!obj.BCBISOTHE__c}" onChange="skipLogic('BCBISOTHE',this.checked)"  styleClass="form-control2 skip-element-BCBISOTHE"/>
                                                Other 
                                            </label>
                                        </td>
                                    </tr>
                                    <tr class="skipContent"><!---Conditional, if Q1 yes----->
                                        <td class="skipContent "><!---Conditional, if Q1 yes----->
                                            
                                            <!--Conditional, if Q2 other, Please specify--->
                                            <div class="skip-BCBISOTHS">
                                                <div class="skip-BCBISOTHE">
                                                    <apex:outputLabel value="Please Specify: " for="BCBISOTHS__c"/>                            
                                                    <apex:inputField styleClass="form-control2 skip-element-BCBISOTHS"  id="BCBISOTHS__c" value="{!obj.BCBISOTHS__c}" label="Please Specify"/><br/>
                                                </div>
                                            </div>
                                            <!--end Please specify---->
                                        </td>
                                    </tr>
                                </table><!--end checkboxes-->
                                
                                <tr class="skip-BCBISCREE"><!--Conditional, if Q1 yes----->
                                    <td>
                                        <b>3.</b>    Date this brief episode of care began: 
                                        <apex:inputField id="BCBISTCDT__c" showDatePicker="true" styleClass="form-control2 auto-width skip-element-BCBISTCDT" value="{!obj.BCBISTCDT__c}"/>
                                    </td>
                                </tr>
                                
                                <tr class="skip-BCBISCREE"><!--Conditional, if Q1 yes----->
                                    <td>        
                                        <p> <b>Answer question 4 <u>after</u> the child/family terminated the selected treatment component(s).</b><br/></p>
                                        <div>
                                            <b>4.</b>  Did this child/family complete the treatment component(s) offered during this brief episode of care?
                                            <apex:selectRadio styleClass="form-control2 skip-element-BCBISCOMP" id="BCBISCOMP__c" value="{!obj.BCBISCOMP__c}" layout="pageDirection"  title="{!obj.BCBISCOMP__c}" >        
                                                <apex:selectOptions value="{!YNCompletedIems}"/>
                                            </apex:selectRadio>   
                                            
                                            <!--- Begin date module------------------>
                                            <div class="skipContent skip-Date">
                                                <div class="skipContent skip-No" >
                                                    <b>Date left treatment:  </b>  
                                                    <apex:inputField id="BCBISLFDT__c" showDatePicker="true"  styleClass="form-control2 auto-width  skip-element-BCBISLFDT " value="{!obj.BCBISLFDT__c}" label="Date left treatment:"/>
                                                </div>
                                                <div class="skipContent skip-Yes" >
                                                    <b>Date completed treatment: </b>
                                                    <apex:inputField id="BCBISCODT__c" showDatePicker="true" styleClass="form-control2 auto-width  skip-element-BCBISCODT" value="{!obj.BCBISCODT__c}" label="Date completed treatment: "/>
                                                </div>
                                            </div>
                                            <!---End of date module---->
                                        </div> 
                                    </td>
                                </tr>   
                            </td>   
                        </tr> <!--end Q1 Conditional-->
                        
                        <tr>
                            <!--Completion status control-->
                            <td class="text-right complete-title">
                                <b>Complete?</b>
                                &nbsp;&nbsp;              
                                <apex:selectList id="STATUS_BIS__c" styleClass="form-control input-sm auto-width" style="width:130px" value="{!obj.STATUS_BIS__c}" size="1">
                                    <apex:selectOption itemValue="Incomplete" itemLabel="Incomplete"/>
                                    <apex:selectOption itemValue="Complete" itemLabel="Complete"/>
                                </apex:selectList> 
                            </td>
                            <!--end completion status-->    
                        </tr>
                        
                    </tbody>
                </table>
            </div>
            
            <!--save and cancel control buttons for pageBlock-->
            <apex:pageBlockButtons >
                <apex:commandButton id="Save" action="{!save}" value="Save"/>
                <apex:commandButton id="Cancel" action="{!cancel}" value="Cancel" rendered="{!if(forceRedirect = '1', false, true)}"/>
            </apex:pageBlockButtons><!--end buttons-->
            
        </apex:pageBlock><!--end BIS pageBlock-->
        
        <apex:actionStatus id="loading" onstart="loading(true)" onstop="loading(false)" />
    </apex:form>
    <!--end form content-->
    
    <!--supplementary styling information-->
    <style>
        .loader {
        background: url('/img/loading32.gif') scroll no-repeat 0 0;
        width: 32px;
        height: 32px;
        position: absolute;
        left: 50%;
        }
    </style>
    <!--end styling-->
    
    <!--loadingBox-->   
    <div id="load_scrl" class="loadingBox loader" style="display:none;"> </div>
    <script type="text/javascript">
    
    function loading(val) {
        if(val) { $j('#load_scrl').css('top', $j(document).scrollTop() + 200); $j('.loadingBox').show(); }
        else $j('.loadingBox').hide();
    }
    </script>
    
    <!--citation information footer-->
    <p style="class:footer; text-align:center ">
        <i>This form is part of the Clinical Improvement through Measurement Initiative (CIMI) of the National Child Traumatic Stress Network (NCTSN) - Baseline - CRF Version 6 2014
        </i>
    </p>
</apex:page>